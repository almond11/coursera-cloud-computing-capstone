SELECT
  o.origin AS airport,
  o.total_departing_flights + d.total_arriving_flights AS total_flights
FROM
  (SELECT origin, count(flightnum) AS total_departing_flights FROM aviation WHERE cancelled = 0 GROUP BY origin) o
  JOIN
  (SELECT dest, count(flightnum) AS total_arriving_flights FROM aviation WHERE cancelled = 0  GROUP BY dest) d
  ON o.origin = d.dest
ORDER BY total_flights DESC;

airport	total_flights
ORD	12051796
ATL	11323515
DFW	10591818
LAX	7586304
PHX	6505078
DEN	6183518
DTW	5504120
IAH	5416653
MSP	5087036
SFO	5062339
STL	5031131
EWR	4979913
LAS	4917971
CLT	4735669
LGA	4179969
BOS	4160565
PHL	3974631
PIT	3855898
SLC	3772753
SEA	3684674
MCO	3682356
CVG	3608316
DCA	3356098
BWI	3182257
SAN	2873824
MIA	2693441
CLE	2661971
IAD	2485562
JFK	2459476
TPA	2458402
HOU	2237673
MEM	2233284
BNA	2198751
MDW	2186580
MCI	2179902
OAK	2163750
SJC	2053084
PDX	1966609
RDU	1912261
FLL	1883718
MSY	1771517
DAL	1766130
IND	1536168
SMF	1519532
SNA	1519381
SAT	1507565
AUS	1491855
ONT	1447980
ABQ	1418398
CMH	1403596
BDL	1198809
BUR	1080161
PBI	994578
HNL	966774
JAX	965722
ELP	962455
RNO	953073
BUF	904984
OKC	897801
TUL	873128
SDF	860266
SJU	857773
MKE	823655
PVD	813629
ORF	797473
TUS	774898
BHM	756388
OMA	755955
RSW	748028
ANC	723735
GSO	718488
DAY	706566
ROC	681842
RIC	659624
SYR	621397
LIT	612897
ALB	540997
COS	501871
GEG	491093
BOI	445902
GRR	445063
MHT	443264
CHS	413711
DSM	409849
ICT	389164
TYS	373684
GSP	371283
JAN	354103
SAV	344996
LBB	321730
SRQ	315859
CAE	313763
OGG	311357
MDT	309256
PWM	296579
HSV	296190
LGB	293353
PNS	292104
MAF	291443
ISP	287719
BTR	280035
PSP	275075
MSN	272151
FAT	256087
LEX	244263
AMA	244001
SHV	239423
CID	235627
ABE	229485
CRP	228315
SBA	223952
MOB	223889
HPN	223365
HRL	215710
BTV	205128
FSD	191366
TLH	191015
FAI	183175
BIL	172503
JNU	164060
DAB	163755
XNA	160574
GRB	158424
MYR	155070
SGF	152302
CAK	151170
KOA	146726
FWA	144306
LIH	140824
MLI	140686
MBS	139028
EUG	136926
BZN	133485
CHA	132133
ROA	129296
MFE	128596
MRY	126334
MLB	125795
LAN	124545
SBN	122230
FAR	121036
LNK	120271
AZO	117876
GTF	113786
CRW	113770
STT	110957
RST	108985
TOL	108849
SWF	107797
ILM	106882
AVL	106538
VPS	106146
FNT	105201
MSO	104823
MFR	103718
MGM	100410
RAP	100213
AGS	99989
BGR	99929
MLU	96581
KTN	95453
GPT	91408
BIS	90703
TRI	90476
EVV	88242
AVP	87006
JAC	85309
FAY	82928
PHF	82830
PIA	79812
SBP	77261
PSC	72808
LFT	71781
BFL	69871
ITO	68011
IDA	67942
GNV	67692
GJT	65486
TVC	63466
FCA	62256
DLH	60703
ERI	54035
SIT	52861
LSE	52382
DET	51251
MOT	51217
STX	50646
CMI	50293
CPR	49733
HLN	49726
BGM	49475
PFN	48818
ATW	45353
EGE	45336
ELM	44741
GFK	44250
ACV	44041
YUM	43191
BMI	41736
GRK	41567
RDM	38981
OME	38856
ABI	38414
OTZ	37561
ACT	37255
SGU	36907
DRO	36755
CHO	36605
TYR	36285
CLL	35949
HDN	35851
BET	35356
CSG	34714
SUN	34121
ITH	34024
SUX	33689
AEX	32939
FSM	32714
LRD	32488
HTS	32421
MTJ	32401
LAW	31725
FLG	31713
SPS	30994
EYW	30888
GUM	29480
SJT	29423
BRO	28104
CDV	27988
YAK	27583
CLD	27179
WRG	27045
PSG	26930
ORH	25302
ASE	24955
EKO	24193
TWF	23822
BRW	23518
RDD	22645
ILE	22378
MOD	22334
SMX	22309
PIH	21021
SCC	20913
TXK	20725
BTM	20648
OAJ	20513
DHN	19983
OXR	18156
ADQ	18027
DBQ	17704
SPN	17458
LYH	17385
GGG	16976
ACY	16912
BPT	16421
BQN	16199
LCH	15348
ABY	15186
GTR	14328
GUC	14215
MCN	13895
VLD	13894
CIC	13778
HVN	13576
BLI	13265
CWA	13261
BQK	13251
COD	13014
PUB	12655
SCE	12533
PIE	12455
MEI	11868
CEC	11856
IYK	11516
AKN	10989
IPL	10986
GCN	10871
ISO	10832
SPI	10708
MQT	10371
FLO	9549
DUT	9237
DLG	8916
UCA	8663
CCR	7953
APF	7286
CDC	7250
EFD	6956
PMD	6472
SCK	6326
TVL	5740
PSE	5471
LWS	5259
VCT	4728
ROR	4238
TUP	3763
VIS	3692
ROP	3658
EAU	3563
GST	3504
HHH	3391
YKM	3339
LWB	3327
ACK	3292
TTN	3220
WYS	3191
RFD	3104
EWN	2513
ALO	2100
ROW	2031
SLE	1759
PLN	1498
ILG	1497
GCC	1478
HKY	1286
YAP	1284
RKS	1166
TEX	1144
ADK	1056
CMX	975
ANI	855
KSM	822
MKG	782
RHI	731
SOP	618
LNY	562
MKK	542
OTH	540
LMT	536
INL	536
BJI	376
MTH	252
MAZ	224
MIB	176
RDR	92
OGD	25
CYS	14
CKB	14
PVU	12
PIR	8
FMN	8
GLH	4
BFF	3
MKC	3
